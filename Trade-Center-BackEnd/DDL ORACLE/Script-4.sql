DROP TABLE TB_PEDIDOS CASCADE CONSTRAINTS;

CREATE TABLE TB_PRODUTO (
    ID_PRODUTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VALOR NUMBER(10,2) NOT NULL,
    NOME VARCHAR2(100) NOT NULL,
    DESCRICAO VARCHAR2(255)
)


CREATE TABLE TB_PEDIDOS (
	ID_PEDIDO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	VALOR_TOTAL NUMBER(10,2) NOT NULL
)

CREATE TABLE TB_ITENS_PEDIDO (
	ID_ITEM NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	ID_PEDIDO NUMBER NOT NULL,
	ID_PRODUTOS NUMBER NOT NULL,
	QUANTIDADE NUMBER NOT NULL,
	VALOR_UNITARIO NUMBER(10,2) NOT NULL,
	
	CONSTRAINT FK_ITEM_PEDIDO FOREIGN KEY (ID_PEDIDO)
		REFERENCES TB_PEDIDOS (ID_PEDIDO),
	
	CONSTRAINT FK_ITEM_PRODUTO FOREIGN KEY (ID_PRODUTOS)
		REFERENCES TB_PRODUTO (ID_PRODUTO)
	
)

INSERT INTO TB_PRODUTO (VALOR, NOME, DESCRICAO)
	VALUES (49.99, 'Caneta', 'Caneta de mil cores')

	
INSERT INTO TB_PRODUTO (VALOR, NOME, DESCRICAO)
	VALUES (125.90, 'Mochila', 'Mochila Preta')

	
INSERT INTO TB_PRODUTO (VALOR, NOME, DESCRICAO, QUANTIDADE)
	VALUES (1599.99, 'Bob Goods', 'Mochila Preta', 1)

	
INSERT INTO TB_PEDIDOS (VALOR_TOTAL) 
VALUES (149.99)
RETURNING ID_PEDIDO INTO :novoId; -- Use este ID no seu c√≥digo Java!

INSERT INTO TB_ITENS_PEDIDO (ID_PEDIDO, ID_PRODUTOS, QUANTIDADE, VALOR_UNITARIO)
VALUES (:novoId, 1, 2, 50.00);


SELECT * FROM TB_PRODUTO
SELECT * FROM TB_PEDIDOS 
SELECT * FROM TB_ITENS_PEDIDO


